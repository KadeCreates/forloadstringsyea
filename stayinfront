-- Follow Script with UI and Debug
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local DISTANCE = 18
local isRunning = false
local targetUsername = ""
local followConnection

-- Create UI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FollowScriptUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 400, 0, 450)
MainFrame.Position = UDim2.new(0.5, -200, 0.5, -225)
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = MainFrame

-- Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -20, 0, 40)
Title.Position = UDim2.new(0, 10, 0, 10)
Title.BackgroundTransparency = 1
Title.Text = "Follow Script v1.0"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 20
Title.Font = Enum.Font.GothamBold
Title.Parent = MainFrame

-- Target Input Label
local InputLabel = Instance.new("TextLabel")
InputLabel.Size = UDim2.new(1, -20, 0, 20)
InputLabel.Position = UDim2.new(0, 10, 0, 60)
InputLabel.BackgroundTransparency = 1
InputLabel.Text = "Target Username:"
InputLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
InputLabel.TextSize = 14
InputLabel.Font = Enum.Font.Gotham
InputLabel.TextXAlignment = Enum.TextXAlignment.Left
InputLabel.Parent = MainFrame

-- Target Input Box
local TargetInput = Instance.new("TextBox")
TargetInput.Size = UDim2.new(1, -20, 0, 35)
TargetInput.Position = UDim2.new(0, 10, 0, 85)
TargetInput.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
TargetInput.BorderSizePixel = 0
TargetInput.Text = ""
TargetInput.PlaceholderText = "Enter username here..."
TargetInput.TextColor3 = Color3.fromRGB(255, 255, 255)
TargetInput.TextSize = 14
TargetInput.Font = Enum.Font.Gotham
TargetInput.ClearTextOnFocus = false
TargetInput.Parent = MainFrame

local InputCorner = Instance.new("UICorner")
InputCorner.CornerRadius = UDim.new(0, 5)
InputCorner.Parent = TargetInput

-- Player List Label
local ListLabel = Instance.new("TextLabel")
ListLabel.Size = UDim2.new(1, -20, 0, 20)
ListLabel.Position = UDim2.new(0, 10, 0, 130)
ListLabel.BackgroundTransparency = 1
ListLabel.Text = "Click a player to select:"
ListLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
ListLabel.TextSize = 14
ListLabel.Font = Enum.Font.Gotham
ListLabel.TextXAlignment = Enum.TextXAlignment.Left
ListLabel.Parent = MainFrame

-- Player List ScrollFrame
local PlayerList = Instance.new("ScrollingFrame")
PlayerList.Size = UDim2.new(1, -20, 0, 100)
PlayerList.Position = UDim2.new(0, 10, 0, 155)
PlayerList.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
PlayerList.BorderSizePixel = 0
PlayerList.ScrollBarThickness = 6
PlayerList.Parent = MainFrame

local ListCorner = Instance.new("UICorner")
ListCorner.CornerRadius = UDim.new(0, 5)
ListCorner.Parent = PlayerList

local ListLayout = Instance.new("UIListLayout")
ListLayout.Padding = UDim.new(0, 5)
ListLayout.Parent = PlayerList

-- Start/Stop Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(1, -20, 0, 40)
ToggleButton.Position = UDim2.new(0, 10, 0, 265)
ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
ToggleButton.BorderSizePixel = 0
ToggleButton.Text = "START FOLLOWING"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 16
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.Parent = MainFrame

local ButtonCorner = Instance.new("UICorner")
ButtonCorner.CornerRadius = UDim.new(0, 5)
ButtonCorner.Parent = ToggleButton

-- Status Label
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, -20, 0, 25)
StatusLabel.Position = UDim2.new(0, 10, 0, 315)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Status: Idle"
StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
StatusLabel.TextSize = 14
StatusLabel.Font = Enum.Font.GothamBold
StatusLabel.Parent = MainFrame

-- Debug Console
local DebugLabel = Instance.new("TextLabel")
DebugLabel.Size = UDim2.new(1, -20, 0, 20)
DebugLabel.Position = UDim2.new(0, 10, 0, 345)
DebugLabel.BackgroundTransparency = 1
DebugLabel.Text = "Debug Console:"
DebugLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
DebugLabel.TextSize = 12
DebugLabel.Font = Enum.Font.Gotham
DebugLabel.TextXAlignment = Enum.TextXAlignment.Left
DebugLabel.Parent = MainFrame

local DebugConsole = Instance.new("TextLabel")
DebugConsole.Size = UDim2.new(1, -20, 0, 70)
DebugConsole.Position = UDim2.new(0, 10, 0, 370)
DebugConsole.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
DebugConsole.BorderSizePixel = 0
DebugConsole.Text = "Waiting for input..."
DebugConsole.TextColor3 = Color3.fromRGB(0, 255, 0)
DebugConsole.TextSize = 11
DebugConsole.Font = Enum.Font.Code
DebugConsole.TextXAlignment = Enum.TextXAlignment.Left
DebugConsole.TextYAlignment = Enum.TextYAlignment.Top
DebugConsole.TextWrapped = true
DebugConsole.Parent = MainFrame

local DebugCorner = Instance.new("UICorner")
DebugCorner.CornerRadius = UDim.new(0, 5)
DebugCorner.Parent = DebugConsole

-- Make draggable
local dragging
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Debug function
local debugMessages = {}
local function addDebug(message)
    table.insert(debugMessages, 1, "[" .. os.date("%X") .. "] " .. message)
    if #debugMessages > 5 then
        table.remove(debugMessages)
    end
    DebugConsole.Text = table.concat(debugMessages, "\n")
end

-- Populate player list
local function updatePlayerList()
    for _, child in pairs(PlayerList:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    local yPos = 0
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local playerButton = Instance.new("TextButton")
            playerButton.Size = UDim2.new(1, -10, 0, 25)
            playerButton.Position = UDim2.new(0, 5, 0, yPos)
            playerButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
            playerButton.BorderSizePixel = 0
            playerButton.Text = player.Name
            playerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            playerButton.TextSize = 12
            playerButton.Font = Enum.Font.Gotham
            playerButton.Parent = PlayerList
            
            local btnCorner = Instance.new("UICorner")
            btnCorner.CornerRadius = UDim.new(0, 3)
            btnCorner.Parent = playerButton
            
            playerButton.MouseButton1Click:Connect(function()
                TargetInput.Text = player.Name
                addDebug("Selected player: " .. player.Name)
            end)
            
            yPos = yPos + 30
        end
    end
    
    PlayerList.CanvasSize = UDim2.new(0, 0, 0, yPos)
end

-- Update player list when players join/leave
Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)
updatePlayerList()

-- Follow function
local function startFollowing()
    if followConnection then
        followConnection:Disconnect()
    end
    
    targetUsername = TargetInput.Text
    
    if targetUsername == "" then
        addDebug("ERROR: No username entered!")
        return
    end
    
    addDebug("Starting follow for: " .. targetUsername)
    
    followConnection = RunService.Heartbeat:Connect(function()
        local target = Players:FindFirstChild(targetUsername)
        
        if not target then
            StatusLabel.Text = "Status: Target not found!"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
            addDebug("ERROR: Player '" .. targetUsername .. "' not in server")
            return
        end
        
        if not target.Character then
            StatusLabel.Text = "Status: Target character not loaded"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 150, 0)
            return
        end
        
        local targetRoot = target.Character:FindFirstChild("HumanoidRootPart")
        if not targetRoot then
            StatusLabel.Text = "Status: Target HRP not found"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 150, 0)
            return
        end
        
        local localChar = LocalPlayer.Character
        if not localChar then
            StatusLabel.Text = "Status: Your character not loaded"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 150, 0)
            return
        end
        
        local localRoot = localChar:FindFirstChild("HumanoidRootPart")
        if not localRoot then
            StatusLabel.Text = "Status: Your HRP not found"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 150, 0)
            return
        end
        
        -- Teleport 15 studs in front
        local targetCFrame = targetRoot.CFrame
        local frontPosition = targetCFrame * CFrame.new(0, 0, -DISTANCE)
        localRoot.CFrame = frontPosition
        
        StatusLabel.Text = "Status: Following " .. targetUsername
        StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    end)
end

local function stopFollowing()
    if followConnection then
        followConnection:Disconnect()
        followConnection = nil
    end
    StatusLabel.Text = "Status: Stopped"
    StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
    addDebug("Stopped following")
end

-- Toggle button
ToggleButton.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    
    if isRunning then
        ToggleButton.Text = "STOP FOLLOWING"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
        startFollowing()
    else
        ToggleButton.Text = "START FOLLOWING"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
        stopFollowing()
    end
end)

-- Respawn handler
LocalPlayer.CharacterAdded:Connect(function()
    if isRunning then
        task.wait(0.5)
        addDebug("Respawned - restarting follow")
        startFollowing()
    end
end)

addDebug("Script loaded successfully!")
addDebug("UI created - ready to use")
print("Follow Script UI loaded!")
